# Production Environment Configuration for Tago Analysis Worker
# Copy this file to stack.env and fill in your values
# NEVER commit .env to version control

# === Core Configuration ===

# Node.js environment (development/production)
NODE_ENV=production

# Required for encryption - generate with: openssl rand -base64 32
SECRET_KEY=your-secret-key-here-generate-with-openssl-rand-base64-32

# Required for WebAuthn and CORS in production
PRODUCTION_DOMAIN=tago-worker.example.com

# Server port (optional, defaults to 3000)
# PORT=3000

# Storage path (optional, defaults to /app/analyses-storage)
# STORAGE_BASE=/app/analyses-storage

# === HTTPS Configuration ===

# Backend SSL certificate paths
CERT_FILE=/app/certs/backend.crt
CERT_KEYFILE=/app/certs/backend.key

# Backend HTTPS port (optional, defaults to 3443)
# HTTPS_PORT=3443

# Frontend SSL certificate paths (nginx-unprivileged)
NGINX_CERT_FILE=/etc/nginx/certs/tago-worker.crt
NGINX_CERT_KEYFILE=/etc/nginx/certs/tago-worker.key

# === Logging Configuration ===

# Log level: debug, info, warn, error
LOG_LEVEL=info

# Show module names in console (default: false)
LOG_INCLUDE_MODULE=false

# === External Logging (Grafana Loki) ===

# Loki server URL - leave empty to disable
# LOG_LOKI_URL=http://loki:3100

# Loki authentication (if required)
# LOG_LOKI_USERNAME=username
# LOG_LOKI_PASSWORD=password

# Additional labels for Loki queries (format: key1=value1,key2=value2)
# LOG_LOKI_LABELS=version=1.0.0,dc=us-east-1

# Loki batching settings
# LOG_LOKI_BATCHING=true
# LOG_LOKI_INTERVAL=5000
# LOG_LOKI_TIMEOUT=30000

# === Docker Runtime ===

# Timezone for consistency across containers
TZ=America/New_York

# === Notes ===
#
# CRITICAL VALUES:
# - SECRET_KEY: Generate with: openssl rand -base64 32
# - PRODUCTION_DOMAIN: Must match your actual domain for auth and CORS
#
# HTTPS:
# - Auto-enabled when both CERT_FILE and CERT_KEYFILE are provided
# - In production, only HTTPS is available for security
#
# OPTIONAL SERVICES:
# - LOG_LOKI_* variables: Only needed if using Grafana Loki
#
# SECURITY:
# - Never commit stack.env to version control
# - Use strong, random values for SECRET_KEY
# - Restrict file permissions: chmod 600 stack.env
